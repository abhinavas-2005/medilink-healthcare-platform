{% extends 'base.html' %}

{% block content %}
<!-- Welcoming message -->
<h2 class="mb-3 fw-bold text-primary"> Welcome, Dr. {{ request.user.username }}!ğŸ‘¨â€âš•ï¸</h2>
<p class="lead text-muted">Your expertise brings healing to patients â€” anytime, anywhere. ğŸ©ºğŸ’¬</p>

<!-- Optional Tip/Info Card -->
<div class="alert alert-info shadow-sm rounded">
  <strong>ğŸ’¡ Tip of the day:</strong> Review and approve appointments early to give patients peace of mind.
</div>

<!-- Appointments Table -->
<div class="table-responsive mt-4">
  <table class="table table-hover table-striped table-bordered rounded shadow">
    <thead class="table-dark">
      <tr>
        <th>ğŸ‘¤ Patient</th>
        <th>ğŸ“… Date</th>
        <th>â° Time</th>
        <th>ğŸ“ Reason</th>
        <th>ğŸ“Œ Status</th>
        <th>âš™ï¸ Actions</th>
      </tr>
    </thead>
    <tbody>
      {% for appointment in appointments %}
      <tr>
        <td>{{ appointment.patient.username }}</td>
        <td>{{ appointment.date }}</td>
        <td>{{ appointment.time }}</td>
        <td>{{ appointment.reason }}</td>
        <td>
          {% if appointment.status == 'Pending' %}
            <span class="badge bg-warning text-dark">Pending</span>
          {% elif appointment.status == 'Approved' %}
            <span class="badge bg-success">Approved</span>
          {% elif appointment.status == 'Rejected' %}
            <span class="badge bg-danger">Rejected</span>
          {% else %}
            <span class="badge bg-secondary">Unknown</span>
          {% endif %}
        </td>
        <td>
          {% if appointment.status == 'Pending' %}
            <a href="{% url 'update_status' appointment.id 'Approved' %}" class="btn btn-sm btn-success mb-1">âœ… Approve</a>
            <a href="{% url 'update_status' appointment.id 'Rejected' %}" class="btn btn-sm btn-danger mb-1">âŒ Reject</a>

          {% elif appointment.status == 'Approved' %}
            {% if appointment.meeting_link %}
              <a href="{{ appointment.meeting_link }}" class="btn btn-sm btn-primary mb-1" target="_blank">ğŸ”— Join Meeting</a>
            {% else %}
              <span class="text-warning fw-bold">âš ï¸ Meeting link not generated</span>
            {% endif %}

          {% elif appointment.status == 'Rejected' %}
            <span class="text-danger">âŒ Rejected</span>
          {% endif %}
        </td>
      </tr>
      {% empty %}
      <tr>
        <td colspan="6" class="text-center text-muted">No appointment requests.</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% endblock %}
